{{ define "main" }}
<div class="main blog-page">
  <div class="blog-intro">
    <h5>TOUS LES ARTICLES</h5>
  </div>

  <section class="recent-section">
    <div class="posts-list">
      {{ $months := dict "January" "Janvier" "February" "Février" "March" "Mars" "April" "Avril" "May" "Mai" "June" "Juin" "July" "Juillet" "August" "Août" "September" "Septembre" "October" "Octobre" "November" "Novembre" "December" "Décembre" }}
      {{ $allPosts := where .Site.RegularPages "Type" "posts" }}
      {{ range $index, $post := $allPosts }}
        {{ $categories := $post.Params.categories }}
        {{ $catSlug := "" }}
        {{ with index $categories 0 }}
          {{ $catSlug = . | urlize }}
        {{ end }}
        {{ $monthEn := $post.Date.Format "January" }}
        {{ $monthFr := index $months $monthEn }}
        {{ $year := $post.Date.Format "2006" }}
        {{ $dateFr := printf "%s %s" $monthFr $year }}
        <article class="post-item" data-category="{{ $catSlug }}">
          {{ $image := $post.Resources.GetMatch "cover" | default (index ($post.Resources.ByType "image") 0) }}
          {{ if $image }}
            {{ $thumb := $image.Fill "800x200 center" }}
            <a href="{{ $post.Permalink }}" class="post-item-link">
              <div class="post-item-image">
                <img src="{{ $thumb.Permalink }}" alt="{{ $post.Title }}" loading="lazy">
                <div class="post-item-overlay">
                  <div class="post-item-meta">
                    {{ with index $categories 0 }}
                      <span class="post-item-category">{{ . | upper }}</span>
                    {{ end }}
                    <span class="post-item-separator">•</span>
                    <span class="post-item-date">{{ $dateFr | upper }}</span>
                  </div>
                  <h3 class="post-item-title">{{ $post.Title }}</h3>
                </div>
              </div>
            </a>
          {{ end }}
        </article>
      {{ end }}
    </div>
  </section>
</div>
{{ end }}
