{{ define "main" }}
  <div class="mb-8 container max-w-4xl mx-auto">
      <p class="text-center mx-4 md:mx-0">
        {{.Content}}
      </p>
  </div>
{{ $allimages := slice }}
{{ range sort (.Resources.ByType "image") "Name" "desc"}}
  {{ $allimages = $allimages | append (dict "Image" .  ) }}
{{ end }}

{{/* Grille asymetrique avec images de tailles variees */}}
<div data-pswp class="w-full px-4 md:px-6">
  <div class="homepage-grid">
    {{ range $index, $img := $allimages }}
      {{/* Pattern: toutes les 5 images = wide (2 colonnes), toutes les 12 images = full (3 colonnes) */}}
      {{ $sizeClass := "grid-item" }}
      {{ if eq (mod $index 12) 0 }}
        {{ $sizeClass = "grid-item grid-item-full" }}
      {{ else if eq (mod $index 5) 0 }}
        {{ $sizeClass = "grid-item grid-item-wide" }}
      {{ end }}

      <div class="{{ $sizeClass }}">
        {{ $src := $img.Image }}
        {{ if $src }}
          {{ $xs := "20x" }}
          {{ $md := "800x" }}
          {{ $lqip := $src.Resize (printf "%s webp" $xs) }}
          {{ $small := $src.Resize (printf "%s webp" $md) }}
          {{ if eq $src.MediaType.SubType "gif" }}
            {{ $lqip = $src.Resize (printf "%s" $xs) }}
            {{ $small = $src }}
          {{ end }}
          <picture class="relative box-border block overflow-hidden">
            <img
              loading="lazy"
              style="background: url(data:image/webp;base64,{{ $lqip.Content | base64Encode }}); background-size: cover"
              alt=""
              class="cursor-pointer object-cover lazy w-full h-full"
              data-action="zoom"
              data-zoom-src="{{ $src.RelPermalink }}"
              src="{{ $small.RelPermalink }}"
              width="{{ $src.Width }}" height="{{ $src.Height }}"/>
          </picture>
        {{ end }}
      </div>
    {{ end }}
  </div>
</div>
{{ end }}
